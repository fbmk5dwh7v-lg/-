<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>标签管理系统</title>
    <script src="https://cdn.jsdelivr.net/npm/react@18.0.0/umd/react.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.0.0/umd/react-dom.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .tree-item { transition: all 0.2s ease; }
        .tree-item:hover { background-color: rgba(59, 130, 246, 0.1); }
        .tree-item.active { background-color: rgba(59, 130, 246, 0.2); }
        .select-height { height: 32px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // 主应用组件
        function App() {
            const [showOriginalModal, setShowOriginalModal] = useState(false);
            const [showRuleModal, setShowRuleModal] = useState(false);
            const [showSQLModal, setShowSQLModal] = useState(false);
            const [expandedNodes, setExpandedNodes] = useState({ 'C端用户': true });
            const [selectedNode, setSelectedNode] = useState('标签管理');
            const [searchTerm, setSearchTerm] = useState('');
            const [tags, setTags] = useState([
                { id: 1, name: '姓名', type: '原始标签', valueType: '字符串', createMethod: '原始映射', taskMethod: '离线任务', status: '运行中', lastRun: '2025-02-03 10:00:00', modified: '2025-04-04 10:00:00' },
                { id: 2, name: '意向城市', type: '原始标签', valueType: '字符串', createMethod: '原始映射', taskMethod: '离线任务', status: '运行中', lastRun: '2025-02-03 10:00:00', modified: '2025-04-04 10:00:00' },
                { id: 3, name: '激活时间', type: '原始标签', valueType: '日期', createMethod: '原始映射', taskMethod: '离线任务', status: '运行中', lastRun: '2025-02-03 10:00:00', modified: '2025-04-04 10:00:00' }
            ]);

            const treeData = [
                { id: 'C端用户', name: 'C端用户', children: ['基本信息', '简历信息'] },
                { id: 'B端员工', name: 'B端员工', children: [] }
            ];

            const [originalModalData, setOriginalModalData] = useState({
                selectedTags: [],
                tagList: [
                    { id: 1, sourceTable: 'C端用户表', sourceField: '真实姓名', valueType: '字符串', name: '真实姓名', description: '', cleanRule: '' },
                    { id: 2, sourceTable: 'C端用户表', sourceField: '意向城市', valueType: '字符串', name: '意向城市', description: '', cleanRule: '' },
                    { id: 3, sourceTable: 'C端用户表', sourceField: '激活时间', valueType: '日期', name: '激活时间', description: '', cleanRule: '' }
                ]
            });

            const [ruleModalData, setRuleModalData] = useState({
                layers: [
                    {
                        id: 1,
                        name: '青年人',
                        description: '',
                        conditions: [
                            { id: 1, field: '年龄', operator: '大于等于', value: '20' },
                            { id: 2, field: '年龄', operator: '小于等于', value: '35' }
                        ]
                    }
                ]
            });

            const [sqlModalData, setSqlModalData] = useState({
                tagType: '原始类',
                tagName: '',
                tagDescription: '',
                tagLocation: '',
                valueType: '字符串',
                sqlContent: 'SELECT * FROM 用户表 WHERE 年龄 BETWEEN 20 AND 35'
            });

            const toggleNode = (nodeId) => {
                setExpandedNodes(prev => ({
                    ...prev,
                    [nodeId]: !prev[nodeId]
                }));
            };

            const handleNodeClick = (nodeId) => {
                setSelectedNode(nodeId);
            };

            const filteredTags = tags.filter(tag => 
                tag.name.toLowerCase().includes(searchTerm.toLowerCase())
            );

            const addOriginalTag = () => {
                const newTag = {
                    id: tags.length + 1,
                    name: originalModalData.tagList[0]?.name || '新标签',
                    type: '原始标签',
                    valueType: originalModalData.tagList[0]?.valueType || '字符串',
                    createMethod: '原始映射',
                    taskMethod: '离线任务',
                    status: '运行中',
                    lastRun: new Date().toISOString().slice(0, 16).replace('T', ' '),
                    modified: new Date().toISOString().slice(0, 16).replace('T', ' ')
                };
                setTags([...tags, newTag]);
                setShowOriginalModal(false);
            };

            const addRuleTag = () => {
                const newTag = {
                    id: tags.length + 1,
                    name: ruleModalData.layers[0]?.name || '新规则标签',
                    type: '规则标签',
                    valueType: '集合',
                    createMethod: '规则映射',
                    taskMethod: '离线任务',
                    status: '运行中',
                    lastRun: new Date().toISOString().slice(0, 16).replace('T', ' '),
                    modified: new Date().toISOString().slice(0, 16).replace('T', ' ')
                };
                setTags([...tags, newTag]);
                setShowRuleModal(false);
            };

            const addSQLTag = () => {
                const newTag = {
                    id: tags.length + 1,
                    name: sqlModalData.tagName || 'SQL标签',
                    type: 'SQL标签',
                    valueType: sqlModalData.valueType,
                    createMethod: 'SQL创建',
                    taskMethod: '离线任务',
                    status: '运行中',
                    lastRun: new Date().toISOString().slice(0, 16).replace('T', ' '),
                    modified: new Date().toISOString().slice(0, 16).replace('T', ' ')
                };
                setTags([...tags, newTag]);
                setShowSQLModal(false);
            };

            const addLayer = () => {
                setRuleModalData(prev => ({
                    ...prev,
                    layers: [...prev.layers, {
                        id: Date.now(),
                        name: '',
                        description: '',
                        conditions: []
                    }]
                }));
            };

            const addCondition = (layerId) => {
                setRuleModalData(prev => ({
                    ...prev,
                    layers: prev.layers.map(layer => 
                        layer.id === layerId 
                            ? { ...layer, conditions: [...layer.conditions, { id: Date.now(), field: '年龄', operator: '大于等于', value: '' }] }
                            : layer
                    )
                }));
            };

            const updateCondition = (layerId, conditionId, field, value) => {
                setRuleModalData(prev => ({
                    ...prev,
                    layers: prev.layers.map(layer => 
                        layer.id === layerId 
                            ? { ...layer, conditions: layer.conditions.map(cond => 
                                cond.id === conditionId ? { ...cond, [field]: value } : cond
                            ) }
                            : layer
                    )
                }));
            };

            const removeCondition = (layerId, conditionId) => {
                setRuleModalData(prev => ({
                    ...prev,
                    layers: prev.layers.map(layer => 
                        layer.id === layerId 
                            ? { ...layer, conditions: layer.conditions.filter(cond => cond.id !== conditionId) }
                            : layer
                    )
                }));
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* 顶部导航栏 */}
                    <header className="bg-gray-800 text-white px-6 py-3 flex items-center justify-between">
                        <div className="flex items-center space-x-6">
                            <div className="flex items-center space-x-2">
                                <div className="w-6 h-6 bg-blue-500 rounded flex items-center justify-center">
                                    <i className="fas fa-tags text-white text-xs"></i>
                                </div>
                                <span className="font-semibold">标签管理系统</span>
                            </div>
                            <div className="flex items-center space-x-4">
                                <div className="flex items-center space-x-2">
                                    <i className="fas fa-home text-gray-300"></i>
                                    <span className="text-sm">我的应用</span>
                                </div>
                                <div className="relative">
                                    <input 
                                        type="text" 
                                        placeholder="搜索操作或者人员" 
                                        className="bg-gray-700 text-white px-3 py-1 rounded text-sm w-64 focus:outline-none focus:bg-gray-600"
                                    />
                                    <i className="fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                </div>
                                <span className="text-sm">首页</span>
                                <div className="bg-blue-600 px-3 py-1 rounded text-sm">标签管理</div>
                            </div>
                        </div>
                        <div className="flex items-center space-x-4">
                            <div className="relative">
                                <i className="fas fa-bell text-gray-300"></i>
                                <span className="absolute -top-1 -right-1 bg-red-500 text-xs rounded-full w-4 h-4 flex items-center justify-center">2</span>
                            </div>
                            <div className="flex items-center space-x-2">
                                <img src="https://picsum.photos/32/32" alt="用户头像" className="w-8 h-8 rounded-full" />
                                <span className="text-sm">谭娟</span>
                                <i className="fas fa-chevron-down text-gray-300"></i>
                            </div>
                            <div className="flex items-center space-x-2">
                                <i className="fas fa-bell text-gray-300"></i>
                                <span className="bg-red-500 text-white text-xs rounded-full px-2 py-1">99+</span>
                            </div>
                            <div className="flex items-center space-x-2">
                                <i className="fas fa-question-circle text-gray-300"></i>
                            </div>
                            <div className="flex items-center space-x-2">
                                <i className="fas fa-download text-gray-300"></i>
                                <span className="text-sm">下载APP</span>
                            </div>
                        </div>
                    </header>

                    <div className="flex">
                        {/* 左侧主导航栏 */}
                        <aside className="w-64 bg-white border-r border-gray-200 min-h-screen">
                            <nav className="p-4">
                                <div className="space-y-1">
                                    <div className="tree-item active px-3 py-2 rounded cursor-pointer flex items-center justify-between" onClick={() => handleNodeClick('数据概览')}>
                                        <div className="flex items-center space-x-2">
                                            <i className="fas fa-chart-bar text-gray-500"></i>
                                            <span className="text-sm">数据概览</span>
                                        </div>
                                        <i className="fas fa-chevron-right text-gray-400 text-xs"></i>
                                    </div>
                                    <div className="tree-item px-3 py-2 rounded cursor-pointer flex items-center justify-between" onClick={() => handleNodeClick('数据分析')}>
                                        <div className="flex items-center space-x-2">
                                            <i className="fas fa-chart-line text-gray-500"></i>
                                            <span className="text-sm">数据分析</span>
                                        </div>
                                        <i className="fas fa-chevron-right text-gray-400 text-xs"></i>
                                    </div>
                                    <div className="tree-item px-3 py-2 rounded cursor-pointer flex items-center justify-between" onClick={() => handleNodeClick('数据录入')}>
                                        <div className="flex items-center space-x-2">
                                            <i className="fas fa-file-import text-gray-500"></i>
                                            <span className="text-sm">数据录入</span>
                                        </div>
                                        <i className="fas fa-chevron-right text-gray-400 text-xs"></i>
                                    </div>
                                    <div className="tree-item px-3 py-2 rounded cursor-pointer flex items-center justify-between" onClick={() => handleNodeClick('数据搭建')}>
                                        <div className="flex items-center space-x-2">
                                            <i className="fas fa-database text-gray-500"></i>
                                            <span className="text-sm">数据搭建</span>
                                        </div>
                                        <i className="fas fa-chevron-right text-gray-400 text-xs"></i>
                                    </div>
                                    <div className="tree-item px-3 py-2 rounded cursor-pointer flex items-center justify-between" onClick={() => handleNodeClick('主数据管理')}>
                                        <div className="flex items-center space-x-2">
                                            <i className="fas fa-cog text-gray-500"></i>
                                            <span className="text-sm">主数据管理</span>
                                        </div>
                                        <i className="fas fa-chevron-right text-gray-400 text-xs"></i>
                                    </div>
                                    <div className="tree-item px-3 py-2 rounded cursor-pointer flex items-center justify-between" onClick={() => handleNodeClick('标签管理')}>
                                        <div className="flex items-center space-x-2">
                                            <i className="fas fa-tags text-gray-500"></i>
                                            <span className="text-sm">标签管理</span>
                                        </div>
                                        <i className="fas fa-chevron-down text-gray-400 text-xs"></i>
                                    </div>
                                    <div className="ml-6 space-y-1">
                                        <div className="tree-item px-3 py-2 rounded cursor-pointer flex items-center justify-between" onClick={() => handleNodeClick('元数据管理')}>
                                            <span className="text-sm text-gray-600">元数据管理</span>
                                        </div>
                                        <div className="tree-item px-3 py-2 rounded cursor-pointer flex items-center justify-between" onClick={() => handleNodeClick('对象管理')}>
                                            <span className="text-sm text-gray-600">对象管理</span>
                                        </div>
                                        <div className="tree-item active px-3 py-2 rounded cursor-pointer flex items-center justify-between" onClick={() => handleNodeClick('标签管理')}>
                                            <span className="text-sm text-blue-600">标签管理</span>
                                        </div>
                                        <div className="tree-item px-3 py-2 rounded cursor-pointer flex items-center justify-between" onClick={() => handleNodeClick('人群圈选')}>
                                            <span className="text-sm text-gray-600">人群圈选</span>
                                        </div>
                                        <div className="tree-item px-3 py-2 rounded cursor-pointer flex items-center justify-between" onClick={() => handleNodeClick('群组列表')}>
                                            <span className="text-sm text-gray-600">群组列表</span>
                                        </div>
                                    </div>
                                </div>
                            </nav>
                        </aside>

                        {/* 中间树形结构 */}
                        <div className="w-80 bg-white border-r border-gray-200 min-h-screen">
                            <div className="p-4">
                                <div className="space-y-2">
                                    {treeData.map(node => (
                                        <div key={node.id}>
                                            <div 
                                                className="flex items-center justify-between px-3 py-2 rounded cursor-pointer hover:bg-gray-100"
                                                onClick={() => toggleNode(node.id)}
                                            >
                                                <div className="flex items-center space-x-2">
                                                    <i className={`fas fa-chevron-${expandedNodes[node.id] ? 'down' : 'right'} text-gray-400 text-xs`}></i>
                                                    <span className="text-sm text-gray-700">{node.name}</span>
                                                </div>
                                            </div>
                                            {expandedNodes[node.id] && (
                                                <div className="ml-6 space-y-1">
                                                    {node.children.map(child => (
                                                        <div 
                                                            key={child}
                                                            className="px-3 py-2 rounded cursor-pointer hover:bg-gray-100 text-sm text-gray-600"
                                                            onClick={() => handleNodeClick(child)}
                                                        >
                                                            {child}
                                                        </div>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* 右侧主内容区 */}
                        <main className="flex-1 p-6">
                            {/* 搜索和操作栏 */}
                            <div className="flex items-center justify-between mb-6">
                                <div className="flex items-center space-x-4">
                                    <div className="relative">
                                        <input 
                                            type="text" 
                                            placeholder="请输入关键词" 
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                            className="border border-gray-300 rounded px-3 py-2 w-64 focus:outline-none focus:border-blue-500"
                                        />
                                        <i className="fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                    </div>
                                </div>
                                <div className="flex space-x-3">
                                    <button 
                                        onClick={() => setShowOriginalModal(true)}
                                        className="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded flex items-center space-x-2"
                                    >
                                        <i className="fas fa-plus"></i>
                                        <span>新增原始标签</span>
                                    </button>
                                    <button 
                                        onClick={() => setShowRuleModal(true)}
                                        className="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded flex items-center space-x-2"
                                    >
                                        <i className="fas fa-plus"></i>
                                        <span>新增规则标签</span>
                                    </button>
                                    <button 
                                        onClick={() => setShowSQLModal(true)}
                                        className="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded flex items-center space-x-2"
                                    >
                                        <i className="fas fa-database"></i>
                                        <span>SQL创建标签</span>
                                    </button>
                                </div>
                            </div>

                            {/* 标签列表 */}
                            <div className="bg-white rounded-lg shadow">
                                <table className="w-full">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">序号</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">对象名称</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">标签类型</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">标签值类型</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">创建方式</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">任务方式</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">任务状态</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">最后执行时间</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">修改时间</th>
                                        </tr>
                                    </thead>
                                    <tbody className="bg-white divide-y divide-gray-200">
                                        {filteredTags.map((tag, index) => (
                                            <tr key={tag.id}>
                                                <td className="px-6 py-4 whitespace-nowrap">
                                                    <div className="flex items-center">
                                                        <div className="w-2 h-2 bg-blue-500 rounded-full mr-2"></div>
                                                        {index + 1}
                                                    </div>
                                                </td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{tag.name}</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{tag.type}</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{tag.valueType}</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{tag.createMethod}</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{tag.taskMethod}</td>
                                                <td className="px-6 py-4 whitespace-nowrap">
                                                    <span className="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                        {tag.status}
                                                    </span>
                                                </td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{tag.lastRun}</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{tag.modified}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </main>
                    </div>

                    {/* 新增原始标签弹窗 */}
                    {showOriginalModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white rounded-lg shadow-xl w-4/5 max-w-4xl max-h-[90vh] overflow-y-auto">
                                <div className="flex items-center justify-between p-6 border-b border-gray-200">
                                    <h3 className="text-lg font-medium text-gray-900">添加原始标签</h3>
                                    <button 
                                        onClick={() => setShowOriginalModal(false)}
                                        className="text-gray-400 hover:text-gray-600"
                                    >
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                <div className="p-6">
                                    <div className="grid grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">标签类型</label>
                                            <select className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height">
                                                <option>原始类</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">选择标签</label>
                                            <select className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height">
                                                <option>基本信息</option>
                                                <option>手机号</option>
                                                <option>邮箱</option>
                                                <option>年龄</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div className="overflow-x-auto">
                                        <table className="min-w-full divide-y divide-gray-200">
                                            <thead className="bg-gray-50">
                                                <tr>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">序号</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">来源表</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">来源字段</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">标签值类型</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">标签名称</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">标签描述</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">清洗规则</th>
                                                </tr>
                                            </thead>
                                            <tbody className="bg-white divide-y divide-gray-200">
                                                {originalModalData.tagList.map((tag, index) => (
                                                    <tr key={tag.id}>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{index + 1}</td>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{tag.sourceTable}</td>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{tag.sourceField}</td>
                                                        <td className="px-6 py-4 whitespace-nowrap">
                                                            <input 
                                                                type="text" 
                                                                value={tag.valueType}
                                                                onChange={(e) => {
                                                                    const updatedList = [...originalModalData.tagList];
                                                                    updatedList[index].valueType = e.target.value;
                                                                    setOriginalModalData({...originalModalData, tagList: updatedList});
                                                                }}
                                                                className="border border-gray-300 rounded px-2 py-1 w-20 focus:outline-none focus:border-blue-500"
                                                            />
                                                        </td>
                                                        <td className="px-6 py-4 whitespace-nowrap">
                                                            <input 
                                                                type="text" 
                                                                value={tag.name}
                                                                onChange={(e) => {
                                                                    const updatedList = [...originalModalData.tagList];
                                                                    updatedList[index].name = e.target.value;
                                                                    setOriginalModalData({...originalModalData, tagList: updatedList});
                                                                }}
                                                                className="border border-gray-300 rounded px-2 py-1 w-24 focus:outline-none focus:border-blue-500"
                                                            />
                                                        </td>
                                                        <td className="px-6 py-4 whitespace-nowrap">
                                                            <input 
                                                                type="text" 
                                                                value={tag.description}
                                                                onChange={(e) => {
                                                                    const updatedList = [...originalModalData.tagList];
                                                                    updatedList[index].description = e.target.value;
                                                                    setOriginalModalData({...originalModalData, tagList: updatedList});
                                                                }}
                                                                className="border border-gray-300 rounded px-2 py-1 w-24 focus:outline-none focus:border-blue-500"
                                                            />
                                                        </td>
                                                        <td className="px-6 py-4 whitespace-nowrap">
                                                            <input 
                                                                type="text" 
                                                                value={tag.cleanRule}
                                                                onChange={(e) => {
                                                                    const updatedList = [...originalModalData.tagList];
                                                                    updatedList[index].cleanRule = e.target.value;
                                                                    setOriginalModalData({...originalModalData, tagList: updatedList});
                                                                }}
                                                                className="border border-gray-300 rounded px-2 py-1 w-24 focus:outline-none focus:border-blue-500"
                                                            />
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div className="flex justify-end space-x-3 p-6 border-t border-gray-200">
                                    <button 
                                        onClick={() => setShowOriginalModal(false)}
                                        className="px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50"
                                    >
                                        取消
                                    </button>
                                    <button 
                                        onClick={addOriginalTag}
                                        className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                                    >
                                        确定
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* 新增规则标签弹窗 */}
                    {showRuleModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white rounded-lg shadow-xl w-4/5 max-w-4xl max-h-[90vh] overflow-y-auto">
                                <div className="flex items-center justify-between p-6 border-b border-gray-200">
                                    <h3 className="text-lg font-medium text-gray-900">添加规则标签</h3>
                                    <button 
                                        onClick={() => setShowRuleModal(false)}
                                        className="text-gray-400 hover:text-gray-600"
                                    >
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                <div className="p-6">
                                    <div className="grid grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">标签类型</label>
                                            <select className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height">
                                                <option>原始类</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">标签名称</label>
                                            <input 
                                                type="text" 
                                                placeholder="员工年龄分层" 
                                                className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"
                                            />
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">选择标签</label>
                                            <select className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height">
                                                <option>基本信息</option>
                                                <option>手机号</option>
                                                <option>邮箱</option>
                                                <option>年龄</option>
                                                <option>城市</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">选择标签</label>
                                            <select className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height">
                                                <option>基本信息</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">标签值类型</label>
                                            <select className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height">
                                                <option>集合</option>
                                                <option>字符串</option>
                                                <option>数字</option>
                                                <option>日期</option>
                                            </select>
                                        </div>
                                    </div>

                                    {/* 分层设置 */}
                                    <div className="mb-6">
                                        <div className="flex items-center justify-between mb-4">
                                            <div className="flex items-center space-x-2">
                                                <span className="px-3 py-1 bg-blue-100 text-blue-800 rounded text-sm">分层1</span>
                                                <button 
                                                    onClick={addLayer}
                                                    className="text-blue-600 text-sm hover:underline"
                                                >
                                                    <i className="fas fa-plus mr-1"></i>
                                                    添加分层
                                                </button>
                                            </div>
                                        </div>
                                        {ruleModalData.layers.map((layer, layerIndex) => (
                                            <div key={layer.id} className="border border-gray-200 rounded p-4 mb-4">
                                                <div className="grid grid-cols-3 gap-4 mb-4">
                                                    <div>
                                                        <label className="block text-sm font-medium text-gray-700 mb-2">名称</label>
                                                        <input 
                                                            type="text" 
                                                            placeholder="青年人" 
                                                            value={layer.name}
                                                            onChange={(e) => {
                                                                const updatedLayers = [...ruleModalData.layers];
                                                                updatedLayers[layerIndex].name = e.target.value;
                                                                setRuleModalData({...ruleModalData, layers: updatedLayers});
                                                            }}
                                                            className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"
                                                        />
                                                    </div>
                                                    <div>
                                                        <label className="block text-sm font-medium text-gray-700 mb-2">描述</label>
                                                        <input 
                                                            type="text" 
                                                            placeholder="请输入..." 
                                                            value={layer.description}
                                                            onChange={(e) => {
                                                                const updatedLayers = [...ruleModalData.layers];
                                                                updatedLayers[layerIndex].description = e.target.value;
                                                                setRuleModalData({...ruleModalData, layers: updatedLayers});
                                                            }}
                                                            className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"
                                                        />
                                                    </div>
                                                </div>
                                                <div className="space-y-3">
                                                    {layer.conditions.map((condition, conditionIndex) => (
                                                        <div key={condition.id} className="flex items-center space-x-4">
                                                            <span className="text-sm text-gray-600">且</span>
                                                            <select 
                                                                value={condition.field}
                                                                onChange={(e) => updateCondition(layer.id, condition.id, 'field', e.target.value)}
                                                                className="border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height"
                                                            >
                                                                <option>年龄</option>
                                                                <option>城市</option>
                                                                <option>收入</option>
                                                                <option>注册时间</option>
                                                            </select>
                                                            <select 
                                                                value={condition.operator}
                                                                onChange={(e) => updateCondition(layer.id, condition.id, 'operator', e.target.value)}
                                                                className="border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height"
                                                            >
                                                                <option>大于等于</option>
                                                                <option>小于等于</option>
                                                                <option>包含</option>
                                                                <option>不包含</option>
                                                                <option>正则匹配</option>
                                                                <option>等于</option>
                                                                <option>不等于</option>
                                                            </select>
                                                            <input 
                                                                type="text" 
                                                                value={condition.value}
                                                                onChange={(e) => updateCondition(layer.id, condition.id, 'value', e.target.value)}
                                                                className="border border-gray-300 rounded px-3 py-2 w-20 focus:outline-none focus:border-blue-500"
                                                            />
                                                            <button 
                                                                onClick={() => removeCondition(layer.id, condition.id)}
                                                                className="text-red-500 hover:text-red-700"
                                                            >
                                                                <i className="fas fa-trash"></i>
                                                            </button>
                                                        </div>
                                                    ))}
                                                </div>
                                                <button 
                                                    onClick={() => addCondition(layer.id)}
                                                    className="text-blue-600 text-sm mt-3 hover:underline"
                                                >
                                                    <i className="fas fa-plus mr-1"></i>
                                                    添加
                                                </button>
                                            </div>
                                        ))}
                                    </div>

                                    {/* 任务时间设置 */}
                                    <div className="border-t border-gray-200 pt-4">
                                        <div className="flex items-center space-x-4">
                                            <button className="text-blue-600 text-sm hover:underline">
                                                <i className="fas fa-plus mr-1"></i>
                                                添加
                                            </button>
                                            <span className="text-sm text-gray-600">任务时间</span>
                                            <select className="border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height">
                                                <option>每天</option>
                                                <option>每周</option>
                                                <option>每月</option>
                                                <option>手动</option>
                                            </select>
                                            <span className="text-sm text-gray-600">的</span>
                                            <select className="border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height">
                                                <option>00时</option>
                                                <option>02时</option>
                                                <option>04时</option>
                                                <option>06时</option>
                                                <option>08时</option>
                                                <option>10时</option>
                                                <option>12时</option>
                                                <option>14时</option>
                                                <option>16时</option>
                                                <option>18时</option>
                                                <option>20时</option>
                                                <option>22时</option>
                                            </select>
                                            <span className="text-sm text-gray-600">:</span>
                                            <select className="border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height">
                                                <option>00分</option>
                                                <option>15分</option>
                                                <option>30分</option>
                                                <option>45分</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div className="flex justify-end space-x-3 p-6 border-t border-gray-200">
                                    <button 
                                        onClick={() => setShowRuleModal(false)}
                                        className="px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50"
                                    >
                                        取消
                                    </button>
                                    <button 
                                        onClick={addRuleTag}
                                        className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                                    >
                                        确定
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* SQL创建标签弹窗 */}
                    {showSQLModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white rounded-lg shadow-xl w-4/5 max-w-4xl max-h-[90vh] overflow-y-auto">
                                <div className="flex items-center justify-between p-6 border-b border-gray-200">
                                    <h3 className="text-lg font-medium text-gray-900">SQL创建标签</h3>
                                    <button 
                                        onClick={() => setShowSQLModal(false)}
                                        className="text-gray-400 hover:text-gray-600"
                                    >
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                <div className="p-6">
                                    <div className="grid grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">标签类型</label>
                                            <select 
                                                value={sqlModalData.tagType}
                                                onChange={(e) => setSqlModalData({...sqlModalData, tagType: e.target.value})}
                                                className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height"
                                            >
                                                <option>原始类</option>
                                                <option>规则类</option>
                                                <option>聚合类</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">标签名称</label>
                                            <input 
                                                type="text" 
                                                value={sqlModalData.tagName}
                                                onChange={(e) => setSqlModalData({...sqlModalData, tagName: e.target.value})}
                                                className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"
                                            />
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">标签描述</label>
                                            <input 
                                                type="text" 
                                                value={sqlModalData.tagDescription}
                                                onChange={(e) => setSqlModalData({...sqlModalData, tagDescription: e.target.value})}
                                                className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">标签位置</label>
                                            <input 
                                                type="text" 
                                                value={sqlModalData.tagLocation}
                                                onChange={(e) => setSqlModalData({...sqlModalData, tagLocation: e.target.value})}
                                                className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"
                                            />
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">标签值类型</label>
                                            <select 
                                                value={sqlModalData.valueType}
                                                onChange={(e) => setSqlModalData({...sqlModalData, valueType: e.target.value})}
                                                className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500 select-height"
                                            >
                                                <option>字符串</option>
                                                <option>数字</option>
                                                <option>日期</option>
                                                <option>布尔值</option>
                                            </select>
                                        </div>
                                    </div>

                                    {/* SQL编辑区域 */}
                                    <div className="mb-6">
                                        <label className="block text-sm font-medium text-gray-700 mb-2">SQL函数</label>
                                        <textarea 
                                            value={sqlModalData.sqlContent}
                                            onChange={(e) => setSqlModalData({...sqlModalData, sqlContent: e.target.value})}
                                            className="w-full border border-gray-300 rounded px-3 py-2 h-32 focus:outline-none focus:border-blue-500 font-mono text-sm"
                                            placeholder="SELECT * FROM 用户表 WHERE 年龄 BETWEEN 20 AND 35"
                                        />
                                    </div>
                                </div>
                                <div className="flex justify-end space-x-3 p-6 border-t border-gray-200">
                                    <button 
                                        onClick={() => setShowSQLModal(false)}
                                        className="px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50"
                                    >
                                        取消
                                    </button>
                                    <button 
                                        onClick={addSQLTag}
                                        className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                                    >
                                        确定
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
